YUI.add("gallery-yui3treeview",function(b){var d=b.ClassNameManager.getClassName,e="treeview",k="tree",c="treeleaf",j="contentBox",i="boundingBox",g="innerHTML",l={},f=true,h=false,a={loading:d(e,"loading"),tree:d(k),treeLabel:d(e,"treelabel"),toggle:d("toggle"),treeview:d(e),collapsed:d(k,"collapsed"),leaf:d(c)};b.TreeView=b.Base.create("treeview",b.Widget,[b.WidgetParent,b.WidgetChild],{initializer:function(m){this.after("parentChange",this._onParentChange,this);this.publish("toggleTreeState",{defaultFn:this._toggleTreeState});l[b.stamp(this.get(i))]=this;},_renderFromMarkup:h,_onParentChange:function(){var q=this.get("depth")>-1,u=q?"<li></li>":"<div></div>",n,p=this.get(i),s,r,m,t=this.getClassName("treelabel"),o;m=b.substitute(this.EXPANDCONTROL_TEMPLATE,{toggleClassName:a.toggle});if(this._renderFromMarkup){s=p.one(":first-child");s.set("role","treeitem");s.addClass(t);s.prepend(m);r=s.get(g);this.set("label",r);this._renderFromMarkup=h;}else{o={treelabelClassName:t,label:this.get("label")};n=b.substitute(this.TREEVIEWLABEL_TEMPLATE,o);n=b.Node.create(n);n.prepend(m);this._set(j,b.Node.create("<ul></ul>"));this._set(i,b.Node.create(u));p=this.get(i).setContent(n);l[b.stamp(p)]=this;}p.set("role","presentation");},CONTENT_TEMPLATE:"<div></div>",BOUNDING_TEMPLATE:"<ul></ul>",TREEVIEWLABEL_TEMPLATE:"<a class={treelabelClassName} role='treeitem' href='#'>{label}</a>",EXPANDCONTROL_TEMPLATE:"<span class={toggleClassName}></span>",bindUI:function(){var n,m;if(this.isRoot()){n=this.get(i);m=this.get(j);n.on("click",this.onViewEvents,this);n.on("keydown",this.onViewEvents,this);n.plug(b.Plugin.NodeFocusManager,{descendants:".yui3-treeleaf-content, .yui3-treeview-treelabel",keys:{next:"down:40",previous:"down:38"},circular:true});}},_createUIEvent:function(o){var r=this._getUIEventNode(),n=(b.stamp(r)+o),q,m=this,p;this._uievts=this._uievts||{};q=this._uievts[n];if(!q){p=r.delegate(o,function(s){var t=m.getByNode(this);t.fire(s.type,{domEvent:s});},"."+b.Widget.getClassName());this._uievts[n]=q={instances:{},handle:p};}q.instances[b.stamp(this)]=1;},getByNode:function(m){var o,n="yui3-widget";m=b.Node.one(m);if(m){m=m.ancestor("."+n,true);if(m){o=l[b.stamp(m,f)];}}return o||null;},renderUI:function(){if(!this.isRoot()){this.get(i).addClass(a.collapsed);}},_toggleTreeState:function(n){var m=n.actionNode.ancestor("."+a.treeview);m.toggleClass(a.collapsed);},_collapseTree:function(n){var m=n.ancestor("."+a.treeview);if(!m.hasClass(a.collapsed)){m.toggleClass(a.collapsed);}},_expandTree:function(n){var m=n.ancestor("."+a.treeview);if(m.hasClass(a.collapsed)){m.toggleClass(a.collapsed);}},onViewEvents:function(q){var s=q.target,m=q.keyCode,o,p,n,r;o=s.get("className").split(" ");r=o.length;q.preventDefault();for(n=0;n<r;n++){p=o[n];switch(p){case a.toggle:this.fire("toggleTreeState",{actionNode:s});break;case a.treeLabel:if(m===39){this._expandTree(s);}else{if(m===37){this._collapseTree(s);}}break;}}}},{NAME:"treeview",ATTRS:{defaultChildType:{value:"TreeLeaf",readOnly:f},label:{validator:b.Lang.isString},loadOnDemand:{value:null}},HTML_PARSER:{children:function(q){var m=q.all("> li"),p=q.ancestor("ul"),o,n=[];if(m.size()>0||p){this._renderFromMarkup=true;}else{this.CONTENT_TEMPLATE=null;}m.each(function(r){var t=r.one(":first-child"),s={srcNode:t,boundingBox:r,contentBox:t,type:null};o=r.one("> ul");if(o){s.type="TreeView";s.contentBox=o;s.srcNode=o;}n.push(s);});return n;}}});b.TreeLeaf=b.Base.create("treeleaf",b.Widget,[b.WidgetChild],{CONTENT_TEMPLATE:"<span></span>",BOUNDING_TEMPLATE:"<li></li>",initializer:function(){l[b.stamp(this.get(i))]=this;},renderUI:function(){this.get(j).setContent(this.get("label"));this.get(i).set("role","treeitem");}},{NAME:"TreeLeaf",ATTRS:{label:{validator:b.Lang.isString},tabIndex:{value:-1}},HTML_PARSER:{label:function(m){return m.get(g);}}});},"gallery-2010.12.10-17-31",{requires:["substitute","widget","widget-parent","widget-child","node-focusmanager"]});